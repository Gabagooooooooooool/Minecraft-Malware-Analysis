# Skidfuscator Extraction 101
## How to extract URLs of malware servers from SkidFuscator protected jars.

## Requirements
- Java Knowledge
- Brain
- RAT File (We will be using https://github.com/skyblockgens/SimpleForaging as an example)
- A copy of Proycon and CFR.

## How i preformed extraction?

First i put the malware trought the RatRater (https://ktibow.github.io/RatRater/) IMEI tool. This allowed me to see what class contained the payload.

< Screenshot >

After this - lets begin!

First we need to focus on the main SkidFuscator obfuscation driver. 

< Screenshot >

Lets simplify and analyze the "flow" of the code. I covered all the private classes, removed "scaring" annotations and highlighted what is returned

< Screenshot >

The paramter is ignored. This main obfuscation driver can be written as 

```java
public class Driver
{
    public static int get(final String ignored) {
        return 419957961
    }
}
```

We will need this class later.

Now let's focus on payload method.

< Screenshot >

When we scroll we can find the ssid getter. But we can find something also intresing 

< Screenshot >

Gotcha! It's the URL. Lets analyze it:

< Screenshot >

Now we take a deeper look at the mysterious var256. It's not defined elsewhere in the code. Decompiler was wrong, but it got an idea - var256 is local int that is used as an encryption key.
The Rm2B7W5ebn is a diffrent thing. We can find the initalization in two places - Beginning of the class and static field. As static fields are initalized after, lets look at it:

< Screenshot >

Bingo! It's using the Driver class. We can simplify this code as:

```java
OnWorldChange.Rm2B7W5ebn = (0xEBE75CA5 ^ (0x5E0D61D3 ^ (0x199D5759 ^ 419957961)) ^ new Random(6744416443638849925L).nextInt());
```
